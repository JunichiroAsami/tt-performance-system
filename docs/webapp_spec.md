# Webアプリケーション仕様書

**ドキュメントID**: SPEC-WEB-01  
**バージョン**: 1.0  
**作成日**: 2026年1月5日  
**作成者**: Manus AI

---

## 1. 概要

### 1.1 目的
卓球パフォーマンス分析システムをWebアプリケーション化し、浅見選手がブラウザから簡単に動画分析・戦略確認・練習計画閲覧ができるようにする。

### 1.2 ターゲットユーザー
- **主要ユーザー**: 浅見江里佳選手（高校生）
- **副次ユーザー**: コーチ、保護者

### 1.3 技術スタック（予定）
- **フロントエンド**: React + TypeScript + TailwindCSS
- **バックエンド**: Node.js (Express) または Python (FastAPI)
- **データベース**: MySQL/TiDB
- **認証**: Manus OAuth
- **AI分析**: Gemini 2.0 Flash API
- **スキャフォールド**: `web-db-user`

---

## 2. 画面構成

### 2.1 画面一覧

| 画面ID | 画面名 | 説明 | モックアップ |
|:---|:---|:---|:---|
| SCR-01 | ダッシュボード | 総合スコア、今日の作戦、クイックアクション | `index.html` |
| SCR-02 | 動画アップロード | 動画ファイルのアップロードと分析オプション選択 | `upload.html` |
| SCR-03 | 分析結果 | 技術評価、得点/失点パターン、改善提案 | `analysis.html` |
| SCR-04 | 戦略シート | 相手情報、勝つためのポイント、場面別作戦 | `strategy.html` |
| SCR-05 | 練習計画 | 5日間の練習メニュー（未作成） | - |
| SCR-06 | 履歴 | 過去の分析結果一覧（未作成） | - |

### 2.2 画面遷移図

```
[ログイン] → [ダッシュボード]
                ├── [動画アップロード] → [分析中...] → [分析結果]
                │                                        ├── [戦略シート]
                │                                        └── [練習計画]
                ├── [戦略シート]（最新の分析結果）
                ├── [練習計画]（最新の分析結果）
                └── [履歴] → [過去の分析結果]
```

---

## 3. 機能要件

### 3.1 認証機能（AUTH）

| 機能ID | 機能名 | 説明 |
|:---|:---|:---|
| AUTH-01 | ログイン | Manus OAuthでログイン |
| AUTH-02 | ログアウト | セッション終了 |
| AUTH-03 | 認証状態維持 | ブラウザを閉じても認証状態を維持 |

### 3.2 動画アップロード機能（UPLOAD）

| 機能ID | 機能名 | 説明 |
|:---|:---|:---|
| UPLOAD-01 | ファイル選択 | MP4, MOV, AVI形式に対応（最大500MB） |
| UPLOAD-02 | ドラッグ＆ドロップ | ファイルをドラッグ＆ドロップでアップロード |
| UPLOAD-03 | 分析オプション選択 | 試合種類、分析項目の選択 |
| UPLOAD-04 | アップロード進捗表示 | アップロード中の進捗バー表示 |

### 3.3 分析機能（ANALYZE）

| 機能ID | 機能名 | 説明 |
|:---|:---|:---|
| ANALYZE-01 | 自己分析 | 技術評価、得点/失点パターン、改善提案 |
| ANALYZE-02 | 相手分析 | 相手の強み、弱点、対策 |
| ANALYZE-03 | 戦略シート生成 | 優先順位付きの作戦、メンタルアドバイス |
| ANALYZE-04 | 練習計画生成 | 5日間の練習メニュー |
| ANALYZE-05 | 分析進捗表示 | 分析中の進捗とステータス表示 |

### 3.4 表示機能（VIEW）

| 機能ID | 機能名 | 説明 |
|:---|:---|:---|
| VIEW-01 | ダッシュボード表示 | 総合スコア、今日の作戦、技術評価グラフ |
| VIEW-02 | 分析結果表示 | タイムスタンプ付きの詳細分析 |
| VIEW-03 | 戦略シート表示 | 詳細版と要約版の切り替え |
| VIEW-04 | 試合用カード表示 | スマホで見やすいA4一枚の要約版 |
| VIEW-05 | 練習計画表示 | 日別の練習メニュー |
| VIEW-06 | 履歴表示 | 過去の分析結果一覧と検索 |

### 3.5 データ管理機能（DATA）

| 機能ID | 機能名 | 説明 |
|:---|:---|:---|
| DATA-01 | 分析結果保存 | 分析結果をデータベースに保存 |
| DATA-02 | 履歴管理 | 過去の分析結果を日付順に管理 |
| DATA-03 | PDF出力 | 戦略シートをPDFでダウンロード |

---

## 4. 非機能要件

### 4.1 パフォーマンス

| 項目 | 要件 |
|:---|:---|
| 動画アップロード | 100MBの動画を30秒以内にアップロード完了 |
| 分析時間 | 3分以内に全分析を完了 |
| 画面表示 | 3秒以内に初期表示完了 |

### 4.2 セキュリティ

| 項目 | 要件 |
|:---|:---|
| 認証 | Manus OAuthによる認証必須 |
| データ保護 | 他ユーザーのデータにアクセス不可 |
| 通信 | HTTPS必須 |

### 4.3 ユーザビリティ

| 項目 | 要件 |
|:---|:---|
| レスポンシブ | スマートフォン、タブレット、PCに対応 |
| 言語 | 日本語のみ |
| 専門用語 | 全ての専門用語に説明を付ける |

---

## 5. データモデル

### 5.1 ユーザー（users）

| カラム | 型 | 説明 |
|:---|:---|:---|
| id | INT | 主キー |
| name | VARCHAR(100) | ユーザー名 |
| email | VARCHAR(255) | メールアドレス |
| created_at | DATETIME | 作成日時 |

### 5.2 分析結果（analyses）

| カラム | 型 | 説明 |
|:---|:---|:---|
| id | INT | 主キー |
| user_id | INT | ユーザーID（外部キー） |
| video_filename | VARCHAR(255) | 動画ファイル名 |
| match_type | VARCHAR(50) | 試合種類 |
| opponent_name | VARCHAR(100) | 対戦相手名 |
| self_analysis | JSON | 自己分析結果 |
| opponent_analysis | JSON | 相手分析結果 |
| strategy | JSON | 戦略シート |
| practice_plan | JSON | 練習計画 |
| created_at | DATETIME | 分析日時 |

---

## 6. API設計

### 6.1 エンドポイント一覧

| メソッド | パス | 説明 |
|:---|:---|:---|
| POST | /api/upload | 動画アップロード |
| POST | /api/analyze | 分析開始 |
| GET | /api/analyses | 分析結果一覧取得 |
| GET | /api/analyses/:id | 分析結果詳細取得 |
| GET | /api/analyses/:id/strategy | 戦略シート取得 |
| GET | /api/analyses/:id/practice | 練習計画取得 |
| GET | /api/analyses/:id/pdf | PDF出力 |

---

## 7. 開発フェーズ

### Phase 1: MVP（最小実行可能製品）
- ログイン機能
- 動画アップロード
- 分析実行（自己分析のみ）
- 分析結果表示

### Phase 2: 相手分析・戦略
- 相手分析機能
- 戦略シート表示
- 要約版（試合用カード）

### Phase 3: 練習計画・履歴
- 練習計画表示
- 履歴管理
- PDF出力

### Phase 4: 改善・最適化
- パフォーマンス最適化
- UI/UX改善
- フィードバック反映

---

## 8. モックアップファイル

以下のモックアップファイルが `docs/mockup/` に作成済み：

| ファイル | 画面 |
|:---|:---|
| `index.html` | ダッシュボード |
| `upload.html` | 動画アップロード |
| `analysis.html` | 分析結果 |
| `strategy.html` | 戦略シート |

ブラウザで直接開いてUI/UXを確認可能。

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|:---|:---|:---|
| 2026-01-05 | 1.0 | 初版作成 |

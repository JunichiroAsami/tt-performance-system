# テスト設計書 v2.0

**ドキュメントID**: QA-03  
**バージョン**: 2.0  
**作成日**: 2026年1月4日  
**作成者**: Manus AI (PM)  
**ステータス**: 完了

---

## 1. 概要

本ドキュメントは、業務要件書v2.0の全要件を、各テストレベル（単体・統合・E2E）でどのように検証するかを定義する。

## 2. テスト方針

- **シフトレフト**: 開発の早い段階（単体・統合テスト）で業務要件の検証を行う。
- **トレーサビリティ**: 全てのテストケースは業務要件IDと紐づける。
- **自動化**: テストは可能な限り自動化し、CI/CDに組み込む。

## 3. 業務要件とテストレベルの対応

| 要件ID | 要件概要 | 単体テスト | 統合テスト | E2Eテスト | UAT |
|:---|:---|:---:|:---:|:---:|:---:|
| **FA-01** | 得点/失点パターン分析 | ✅ | ✅ | ✅ | ✅ |
| **FA-02** | 技術別パフォーマンス分析 | ✅ | ✅ | ✅ | ✅ |
| **FA-03** | サーブ/レシーブ分析 | ✅ | ✅ | ✅ | ✅ |
| **FA-04** | フォーム分析 | ✅ | - | ✅ | ✅ |
| **FA-05** | フットワーク分析 | ✅ | - | ✅ | ✅ |
| **FA-06** | 相手の得点/失点パターン分析 | ✅ | ✅ | - | ✅ |
| **FA-07** | 相手のサーブ/レシーブ傾向分析 | ✅ | - | - | ✅ |
| **FA-08** | 相手の弱点特定 | ✅ | - | - | ✅ |
| **FS-01** | 対戦相手別戦略シート生成 | ✅ | ✅ | ✅ | ✅ |
| **FS-02** | サーブ戦略提案 | ✅ | ✅ | ✅ | ✅ |
| **FS-03** | レシーブ戦略提案 | ✅ | ✅ | ✅ | ✅ |
| **FS-04** | ラリー展開戦略提案 | ✅ | ✅ | ✅ | ✅ |
| **FP-01** | 課題の優先順位付け | ✅ | ✅ | ✅ | ✅ |
| **FP-02** | カスタム練習メニュー生成 | ✅ | ✅ | ✅ | ✅ |
| **FP-03** | フォーム改善ドリル提案 | ✅ | ✅ | ✅ | ✅ |
| **FR-01** | 試合後サマリーレポート | - | ✅ | ✅ | ✅ |
| **FR-02** | パフォーマンスダッシュボード | - | - | - | Phase 2 |
| **FR-03** | プレー動画へのアノテーション | - | - | - | Phase 2 |

- ✅: 検証済み
- -: 対象外（他レベルで検証）
- Phase 2: 次フェーズで実装予定

## 4. テストファイル構成

```
tests/
├── unit/
│   ├── test_requirements.py      # 業務要件ベース単体テスト（19件）
│   ├── test_llm_analyzer.py      # LLMAnalyzerの単体テスト
│   ├── test_prompts.py           # プロンプトの単体テスト
│   └── test_report_generator.py  # レポート生成の単体テスト
├── integration/
│   ├── test_analysis_flow.py     # 分析フローの統合テスト
│   └── test_requirements_validation.py  # 業務要件ベース統合テスト（17件）
└── e2e/
    ├── test_cli.py               # CLIのE2Eテスト
    └── test_requirements_e2e.py  # 業務要件ベースE2Eテスト（13件）
```

## 5. テスト実行方法

```bash
# 全テスト実行
python3 -m pytest tests/ -v

# 単体テストのみ
python3 -m pytest tests/unit/ -v

# 統合テストのみ
python3 -m pytest tests/integration/ -v

# E2Eテストのみ
python3 -m pytest tests/e2e/ -v

# 業務要件ベーステストのみ
python3 -m pytest tests/ -k "requirements" -v
```

## 6. 変更履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|:---|:---|:---|:---|
| 2026-01-04 | 1.0 | 初版作成 | PM |
| 2026-01-04 | 2.0 | テスト実行結果を反映、ファイル構成追加 | PM |
